<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Host page embedding Apps Script</title>
    <style>
      body { font-family: Arial, sans-serif; padding: 16px; }
      iframe { 
        width: 100%; 
        height: 500px; 
        border: 1px solid #ccc; 
        border-radius: 6px; 
      }
      .controls { margin-bottom: 12px; }
    </style>
  </head>
  <body>
    <h2>Host page</h2>

    <div class="controls">
      <label>Message to iframe:
        <input id="msg" type="text" value="Hello iframe!" />
      </label>
      <button id="send">Send</button>
      <button id="goFull">Go Fullscreen</button>
    </div>

    <!-- Replace with your deployed Apps Script web app URL -->
    <iframe 
      id="as-frame" 
      src="https://script.google.com/macros/s/AKfycbyGHdYayLl6njQY1qDeq9Ay_9a17B-bs--tjF5RgzONMNcm0o6NKBMUTyZu9IZAj8aM/exec" 
      title="MCR Nation"
      allowfullscreen
    ></iframe>

    <p id="reply">Waiting for message from iframe...</p>

    <script>
      const iframe = document.getElementById('as-frame');
      const sendBtn = document.getElementById('send');
      const msgInput = document.getElementById('msg');
      const reply = document.getElementById('reply');
      const goFullBtn = document.getElementById('goFull');

      // Send message to iframe
      sendBtn.addEventListener('click', () => {
        const message = msgInput.value;
        iframe.contentWindow.postMessage(message, '*');
      });

      // Listen for messages from iframe
      window.addEventListener('message', (event) => {
        reply.textContent = 'Message from iframe: ' + event.data;
      }, false);

      // Trigger fullscreen programmatically
      goFullBtn.addEventListener('click', () => {
        if (iframe.requestFullscreen) {
          iframe.requestFullscreen();
        } else if (iframe.webkitRequestFullscreen) { // Safari
          iframe.webkitRequestFullscreen();
        } else if (iframe.msRequestFullscreen) { // IE/Edge
          iframe.msRequestFullscreen();
        }
      });
    </script>
  </body>
</html>
